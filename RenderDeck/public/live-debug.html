<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RenderDeck Live Debug</title>
  <script type="importmap">{
    "imports": {
      "three": "https://unpkg.com/three@0.175.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.175.0/examples/jsm/"
    }
  }</script>
  <style>
    body {
      font-family: monospace;
      background: #1a1a1a;
      color: #0f0;
      padding: 20px;
      margin: 0;
    }
    .log {
      background: #000;
      padding: 20px;
      border: 2px solid #0f0;
      border-radius: 8px;
      max-height: 90vh;
      overflow-y: auto;
    }
    .log-entry {
      margin: 5px 0;
      padding: 5px;
      border-left: 3px solid #0f0;
      padding-left: 10px;
    }
    .error {
      color: #f44;
      border-left-color: #f44;
    }
    .success {
      color: #4f4;
      border-left-color: #4f4;
    }
    .info {
      color: #4af;
      border-left-color: #4af;
    }
    .warn {
      color: #fa4;
      border-left-color: #fa4;
    }
    h1 {
      color: #4f4;
      text-shadow: 0 0 10px #0f0;
    }
  </style>
</head>
<body>
  <h1>üîç RenderDeck Live Debug Monitor</h1>
  <p style="color: #aaa;">Watching main.js execution in real-time...</p>
  <div class="log" id="log"></div>
  
  <script type="module">
    const logDiv = document.getElementById('log');
    
    function addLog(message, type = 'info') {
      const entry = document.createElement('div');
      entry.className = `log-entry ${type}`;
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logDiv.appendChild(entry);
      logDiv.scrollTop = logDiv.scrollHeight;
      console.log(message);
    }
    
    addLog('üöÄ Starting debug...', 'info');
    
    // Test 1: Can we import config?
    try {
      addLog('üì¶ Importing config.js...', 'info');
      const { CONFIG, MODEL_PATHS, SCENE_PATHS } = await import('./js/config.js');
      addLog('‚úÖ Config loaded successfully', 'success');
      addLog(`   MODEL_PATHS.BASE_PATH: ${MODEL_PATHS.BASE_PATH}`, 'info');
      addLog(`   SCENE_PATHS.BASE_PATH: ${SCENE_PATHS.BASE_PATH}`, 'info');
      
      // Check model paths
      const modelKeys = Object.keys(MODEL_PATHS).filter(k => k !== 'BASE_PATH');
      addLog(`   Found ${modelKeys.length} models in config: ${modelKeys.join(', ')}`, 'info');
      
    } catch (e) {
      addLog(`‚ùå Config import failed: ${e.message}`, 'error');
    }
    
    // Test 2: Can we import main.js?
    try {
      addLog('üì¶ Importing main.js...', 'info');
      await import('./js/main.js');
      addLog('‚úÖ main.js imported successfully', 'success');
    } catch (e) {
      addLog(`‚ùå main.js import failed: ${e.message}`, 'error');
      addLog(`   Stack: ${e.stack}`, 'error');
    }
    
    // Test 3: Wait a bit and check DOM
    setTimeout(() => {
      addLog('üîç Checking DOM elements...', 'info');
      
      const container = document.querySelector('.scene-view-placeholder');
      addLog(`   .scene-view-placeholder: ${container ? 'FOUND' : 'NOT FOUND'}`, container ? 'success' : 'error');
      
      if (container) {
        const canvas = container.querySelector('canvas');
        addLog(`   Canvas element: ${canvas ? 'FOUND' : 'NOT FOUND'}`, canvas ? 'success' : 'warn');
        
        if (canvas) {
          addLog(`   Canvas size: ${canvas.width}x${canvas.height}`, 'info');
        }
      }
      
      const modelSelect = document.getElementById('model-select');
      addLog(`   #model-select: ${modelSelect ? 'FOUND' : 'NOT FOUND'}`, modelSelect ? 'success' : 'error');
      
      if (modelSelect) {
        addLog(`   Options count: ${modelSelect.options.length}`, 'info');
        for (let i = 0; i < modelSelect.options.length; i++) {
          addLog(`     - ${modelSelect.options[i].text}`, 'info');
        }
      }
      
      const sceneSelect = document.getElementById('scene-select');
      addLog(`   #scene-select: ${sceneSelect ? 'FOUND' : 'NOT FOUND'}`, sceneSelect ? 'success' : 'error');
      
      const debug = document.querySelector('.debug p');
      addLog(`   .debug p: ${debug ? 'FOUND' : 'NOT FOUND'}`, debug ? 'success' : 'warn');
      if (debug) {
        addLog(`   Debug text: "${debug.textContent}"`, 'info');
      }
      
    }, 2000);
    
    // Test 4: Check window globals
    setTimeout(() => {
      addLog('üîç Checking window globals...', 'info');
      addLog(`   window.THREE: ${typeof window.THREE}`, 'info');
      addLog(`   window.scene: ${typeof window.scene}`, 'info');
      addLog(`   window.camera: ${typeof window.camera}`, 'info');
      addLog(`   window.renderer: ${typeof window.renderer}`, 'info');
      
    }, 3000);
    
    // Test 5: Listen for console logs
    const originalLog = console.log;
    const originalError = console.error;
    
    console.log = function(...args) {
      if (args[0] && typeof args[0] === 'string') {
        if (args[0].includes('‚úì') || args[0].includes('loaded')) {
          addLog(`üìù ${args.join(' ')}`, 'success');
        } else if (args[0].includes('‚ö†Ô∏è') || args[0].includes('warning')) {
          addLog(`üìù ${args.join(' ')}`, 'warn');
        } else {
          addLog(`üìù ${args.join(' ')}`, 'info');
        }
      }
      originalLog.apply(console, args);
    };
    
    console.error = function(...args) {
      addLog(`‚ùå ${args.join(' ')}`, 'error');
      originalError.apply(console, args);
    };
    
    addLog('üëÇ Listening for console messages...', 'info');
    
    // Test 6: Check after full load
    window.addEventListener('load', () => {
      setTimeout(() => {
        addLog('üéØ Final check after page load...', 'info');
        
        // Check if Three.js scene is rendering
        const canvases = document.querySelectorAll('canvas');
        addLog(`   Total canvas elements: ${canvases.length}`, 'info');
        
        canvases.forEach((canvas, i) => {
          addLog(`   Canvas ${i + 1}: ${canvas.width}x${canvas.height}, parent: ${canvas.parentElement?.className}`, 'info');
        });
        
        // Summary
        addLog('', 'info');
        addLog('=== SUMMARY ===', 'info');
        addLog('If you see:', 'info');
        addLog('  ‚úÖ main.js imported successfully', 'success');
        addLog('  ‚úÖ Canvas element found', 'success');
        addLog('  ‚úÖ Model options in dropdown', 'success');
        addLog('  ‚úÖ Console messages from main.js', 'success');
        addLog('', 'info');
        addLog('BUT still no 3D model visible...', 'warn');
        addLog('', 'info');
        addLog('Then the issue is likely:', 'warn');
        addLog('  1. CSS hiding the canvas', 'warn');
        addLog('  2. Canvas size is 0x0', 'warn');
        addLog('  3. Model loading but not visible (camera/lighting)', 'warn');
        addLog('  4. Container has no height/width', 'warn');
        addLog('', 'info');
        addLog('üìã Copy this entire log and share it!', 'info');
        
      }, 1000);
    });
    
  </script>
  
  <!-- Now load the actual index.html in an iframe to monitor it -->
  <script>
    setTimeout(() => {
      const entry = document.createElement('div');
      entry.className = 'log-entry info';
      entry.innerHTML = '<br><strong>üí° TIP: Open your actual index.html in another tab and compare console messages!</strong>';
      document.getElementById('log').appendChild(entry);
    }, 5000);
  </script>
</body>
</html>